/////////////////////////////////////////////////////////////////////////////////////////////////////
// Global Variables
/////////////////////////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////////////////////////////
// Load Modules
/////////////////////////////////////////////////////////////////////////////////////////////////////
var util = require('./util');
var auth = require('./auth');

/////////////////////////////////////////////////////////////////////////////////////////////////////
// Routes
/////////////////////////////////////////////////////////////////////////////////////////////////////
module.exports = function(app, passport) {

	// =============================================================================================
	// TEST PAGE
	// =============================================================================================
	app.get('/', function(req, res) {
		res.sendStatus(200);
	});

	// =============================================================================================
	// API
	// =============================================================================================
	app.all('/api/*', passport.authenticate('ldapauth', {session: false}))

	// status
	app.post('/api/status', function(req, res) {
		res.json(util.getStatus());
	});

	// path
	app.post('/api/path', auth.isAdmin, function(req, res) {
	    console.log(req.user)
	    res.send({status: 'ok'});
	});

	// =============================================================================================
	// NOT FOUND
	// =============================================================================================
	app.all('*', function(req, res){util.notFound(req,res);});
};
//////////////////////////////////////////////////////////////////////////////////////////////////////